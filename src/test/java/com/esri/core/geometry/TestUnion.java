/*
 Copyright 1995-2017 Esri

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.

 For additional information, contact:
 Environmental Systems Research Institute, Inc.
 Attn: Contracts Dept
 380 New York Street
 Redlands, California, USA 92373

 email: contracts@esri.com
 */

package com.esri.core.geometry;

import junit.framework.TestCase;
import org.junit.Test;

import java.nio.ByteBuffer;
import java.util.*;
import java.util.stream.Collectors;

public class TestUnion extends TestCase {
	public ArrayDeque<Geometry> pointList = null;
	public ArrayDeque<Geometry> bufferedPointList = null;

	@Override
	protected void setUp() throws Exception {
		Random random = new Random(1977);
		int max_size = 10000;
		pointList = new ArrayDeque<>(max_size);
		bufferedPointList = new ArrayDeque<>(max_size);
		for (int i = 0; i < max_size; i++) {
			double x = randomWithRange(-20, 20, random);
			double y = randomWithRange(-20, 20, random);
			Geometry point = new Point(x, y);
			pointList.add(point);
			bufferedPointList.add(OperatorBufferLocal.local().execute(point, null, 2.5, null));
		}

		super.setUp();
	}

	@Override
	protected void tearDown() throws Exception {
		super.tearDown();
	}

	@Test
	public void testUnion() {
		Point pt = new Point(10, 20);

		Point pt2 = new Point();
		pt2.setXY(10, 10);

		Envelope env1 = new Envelope(10, 10, 30, 50);
		Envelope env2 = new Envelope(30, 10, 60, 50);
		Geometry[] geomArray = new Geometry[]{env1, env2};
		SimpleGeometryCursor inputGeometries = new SimpleGeometryCursor(
				geomArray);
		OperatorUnion union = (OperatorUnion) OperatorFactoryLocal
				.getInstance().getOperator(Operator.Type.Union);

		SpatialReference sr = SpatialReference.create(4326);

		GeometryCursor outputCursor = union.execute(inputGeometries, sr, null);
		Geometry result = outputCursor.next();

		MultiPath path = (MultiPath)result;
		assertEquals(1, path.getPathCount());
		assertEquals(6, path.getPathEnd(0));
		assertEquals(new Point2D(10, 10), path.getXY(0));
		assertEquals(new Point2D(10, 50), path.getXY(1));
		assertEquals(new Point2D(30, 50), path.getXY(2));
		assertEquals(new Point2D(60, 50), path.getXY(3));
		assertEquals(new Point2D(60, 10), path.getXY(4));
		assertEquals(new Point2D(30, 10), path.getXY(5));
	}

	@Test
	public static void testUnionDistinctGeometries() {
		Envelope env = new Envelope(1, 5, 3, 10);

		Polygon polygon = new Polygon();
		polygon.startPath(new Point(4, 3));
		polygon.lineTo(new Point(7, 6));
		polygon.lineTo(new Point(6, 8));
		polygon.lineTo(new Point(4, 3));

		Geometry[] geomArray = new Geometry[] { env, polygon };
		SimpleGeometryCursor inputGeometries = new SimpleGeometryCursor(
				geomArray);
		OperatorUnion union = (OperatorUnion) OperatorFactoryLocal
				.getInstance().getOperator(Operator.Type.Union);
		SpatialReference sr = SpatialReference.create(4326);

		GeometryCursor outputCursor = union.execute(inputGeometries, sr, null);
		Geometry result = outputCursor.next();

		MultiPath path = (MultiPath)result;
		assertEquals(2, path.getPathCount());

		assertEquals(3, path.getPathEnd(0));
		assertEquals(7, path.getPathEnd(1));
		// from polygon
		assertEquals(new Point2D(4, 3), path.getXY(0));
		assertEquals(new Point2D(6, 8), path.getXY(1));
		assertEquals(new Point2D(7, 6), path.getXY(2));
		// from envelope
		assertEquals(new Point2D(1, 5), path.getXY(3));
		assertEquals(new Point2D(1, 10), path.getXY(4));
		assertEquals(new Point2D(3, 10), path.getXY(5));
		assertEquals(new Point2D(3, 5), path.getXY(6));
	}

	@Test
	public static void testUnionCoincidentPolygons() {
		Polygon polygon1 = new Polygon();
		polygon1.startPath(new Point(3, 2));
		polygon1.lineTo(new Point(1, 2));
		polygon1.lineTo(new Point(1, 4));
		polygon1.lineTo(new Point(3, 4));
		polygon1.lineTo(new Point(3, 2));

		Polygon polygon2 = new Polygon();
		polygon2.startPath(new Point(1, 2));
		polygon2.lineTo(new Point(1, 4));
		polygon2.lineTo(new Point(3, 4));
		polygon2.lineTo(new Point(3, 2));
		polygon2.lineTo(new Point(1, 2));

		Geometry[] geomArray = new Geometry[] { polygon1, polygon2 };
		SimpleGeometryCursor inputGeometries = new SimpleGeometryCursor(
				geomArray);
		OperatorUnion union = (OperatorUnion) OperatorFactoryLocal
				.getInstance().getOperator(Operator.Type.Union);
		SpatialReference sr = SpatialReference.create(4326);

		GeometryCursor outputCursor = union.execute(inputGeometries, sr, null);
		Geometry result = outputCursor.next();

		MultiPath path = (MultiPath)result;
		assertEquals(1, path.getPathCount());
		assertEquals(4, path.getPathEnd(0));
		assertEquals(new Point2D(1, 2), path.getXY(0));
		assertEquals(new Point2D(1, 4), path.getXY(1));
		assertEquals(new Point2D(3, 4), path.getXY(2));
		assertEquals(new Point2D(3, 2), path.getXY(3));
	}

	@Test
	public static void testUnionCoincidentPolygonsWithReverseWinding() {
		// Input polygons have CCW winding, result is always CW
		Polygon polygon1 = new Polygon();
		polygon1.startPath(new Point(3, 2));
		polygon1.lineTo(new Point(3, 4));
		polygon1.lineTo(new Point(1, 4));
		polygon1.lineTo(new Point(1, 2));
		polygon1.lineTo(new Point(3, 2));

		Polygon polygon2 = new Polygon();
		polygon2.startPath(new Point(1, 2));
		polygon2.lineTo(new Point(3, 2));
		polygon2.lineTo(new Point(3, 4));
		polygon2.lineTo(new Point(1, 4));
		polygon2.lineTo(new Point(1, 2));

		Polygon expectedPolygon = new Polygon();
		expectedPolygon.startPath(new Point(1, 2));
		expectedPolygon.lineTo(new Point(1, 4));
		expectedPolygon.lineTo(new Point(3, 4));
		expectedPolygon.lineTo(new Point(3, 2));
		expectedPolygon.lineTo(new Point(1, 2));

		Geometry[] geomArray = new Geometry[] { polygon1, polygon2 };
		SimpleGeometryCursor inputGeometries = new SimpleGeometryCursor(
				geomArray);
		OperatorUnion union = (OperatorUnion) OperatorFactoryLocal
				.getInstance().getOperator(Operator.Type.Union);
		SpatialReference sr = SpatialReference.create(4326);

		GeometryCursor outputCursor = union.execute(inputGeometries, sr, null);
		Geometry result = outputCursor.next();

		MultiPath path = (MultiPath)result;
		assertEquals(1, path.getPathCount());
		assertEquals(4, path.getPathEnd(0));
		assertEquals(new Point2D(1, 2), path.getXY(0));
		assertEquals(new Point2D(1, 4), path.getXY(1));
		assertEquals(new Point2D(3, 4), path.getXY(2));
		assertEquals(new Point2D(3, 2), path.getXY(3));
	}

	static double randomWithRange(double min, double max, Random random) {
		double range = Math.abs(max - min);
		return (random.nextDouble() * range) + (min <= max ? min : max);
	}


//	@Test
//    @Ignore
//	public void testBufferUnionEnvelope() {
//		int size = 1000;
//        Random random = new Random(1977);
//		List<Geometry> envList = new ArrayList<>(size);
//		Envelope2D envelope2D = new Envelope2D();
//		for (int i = 0; i < size; i++){
//		    pointList.pop().queryEnvelope2D(envelope2D);
//			Envelope2D envelope2D1 = envelope2D.getInflated(5, 5);
//			Envelope envelope = new Envelope(envelope2D1);
//			envList.add(envelope);
//		}
//		SimpleGeometryCursor simpleGeometryCursor = new SimpleGeometryCursor(envList);
//		double[] d = {2.5};
//		OperatorUnionCursor operatorUnionCursor = new OperatorUnionCursor(simpleGeometryCursor, null, null);
//		Geometry result = operatorUnionCursor.next();
//		assertTrue(result.calculateArea2D() > 40 * 40);
//	}

//    @Ignore
//    @Test
//    public void testBufferUnionPoint() {
//        int size = 10000;
//        SimpleGeometryCursor simpleGeometryCursor = new SimpleGeometryCursor(bufferedPointList);
//
//        double[] d = {2.5};
//        OperatorUnionCursor operatorUnionCursor = new OperatorUnionCursor(simpleGeometryCursor, null, null);
//
//        // Tests union on buffer at next call
//        long startTime = System.nanoTime();
//        Geometry result = operatorUnionCursor.next();
//        long endTime = System.nanoTime();
//        long duration = (endTime - startTime) / 1000000;
//        System.out.println(result.calculateArea2D());
//        System.out.println(duration);
//        assertTrue(result.calculateArea2D() > 40 * 40);
//    }

	@Test
	public void testQuadTreeIterator() {
		int size = 1000;
		ArrayDeque<Geometry> bufferedArrayDequ = new ArrayDeque<>(new ArrayList<>(bufferedPointList).subList(0, size));
		SimpleGeometryCursor simpleGeometryCursor = new SimpleGeometryCursor(bufferedArrayDequ);

		HashMap<Integer, Geometry> m_quadTreeMap = new HashMap<>();
		Envelope2D quad_envelope2D = new Envelope2D();
		Geometry geometry = null;
		Envelope2D geometry_env = new Envelope2D();
		int count_index = 0;
		while ((geometry = simpleGeometryCursor.next()) != null) {
			geometry.queryEnvelope2D(geometry_env);
			quad_envelope2D.merge(geometry_env);
			m_quadTreeMap.put(count_index++, geometry);
		}
		QuadTree quadTree = new QuadTree(quad_envelope2D, 16);
		for (Integer element_id : m_quadTreeMap.keySet()) {
			m_quadTreeMap.get(element_id).queryEnvelope2D(geometry_env);
			quadTree.insert(element_id, geometry_env);
		}

		QuadTree.QuadTreeIterator quadTreeIterator = quadTree.getIterator(true);
		quadTreeIterator.resetIterator(quad_envelope2D, 0.0);
		int element_handle = -1;
		List<Geometry> geometryList = new ArrayList<>();
		assertFalse(geometryList.containsAll(m_quadTreeMap.values()));

		int max_height = 0;
		while ((element_handle = quadTreeIterator.next()) != -1) {
			int element_id = quadTree.getElement(element_handle);
			int quad_handle = quadTree.getQuad(element_handle);

			int sub_count = quadTree.getContainedSubTreeElementCount(quad_handle);
			int sub_count_2 = quadTree.getSubTreeElementCount(quad_handle);

			int quad_height = quadTree.getHeight(quad_handle);
			max_height = quad_height > max_height ? quad_height : max_height;
			Envelope2D envelope2D = quadTree.getExtent(quad_handle);
			assertTrue(quadTree.hasData(envelope2D, 0.0));
			geometryList.add(m_quadTreeMap.get(element_id));
		}
		assertTrue(max_height == 3);
		assertEquals(16, quadTree.getMaxHeight());

		assertTrue(geometryList.containsAll(m_quadTreeMap.values()));
	}


	@Test
	public static void testFailedUnionDifferenceTest() {
		// shapely result for union
		String shapelyWKT = "POLYGON ((-14.50430349127707 -22.07059031842225, -14.51281964335354 -22.0769063272619, -14.72325338383755 -22.20303545737643, -14.94503664498982 -22.30793112778376, -15.17603353276639 -22.39058313583606, -15.41401942086222 -22.45019549751362, -15.65670237507864 -22.48619411318603, -15.90174522590254 -22.49823229650554, -16.14678807672644 -22.48619411318603, -16.38947103094286 -22.45019549751362, -16.4990865892769 -22.42273822951685, -16.65632769437413 -22.44606274412307, -16.90137054519803 -22.45810092744258, -17.14641339602193 -22.44606274412307, -17.38909635023835 -22.41006412845066, -17.62708223833419 -22.35045176677311, -17.85807912611075 -22.2677997587208, -17.86833950280889 -22.2629469619552, -17.93163213536989 -22.26605632960654, -18.15038036764053 -22.25530991806244, -18.32212283929288 -22.31676035701235, -18.56010872738872 -22.37637271868991, -18.80279168160514 -22.41237133436232, -19.04783453242904 -22.42440951768183, -19.29287738325294 -22.41237133436232, -19.53556033746936 -22.37637271868991, -19.63541513605011 -22.3513603937329, -19.66115167971507 -22.35009603841869, -19.90383463393149 -22.31409742274627, -20.14182052202732 -22.25448506106872, -20.37281740980389 -22.17183305301641, -20.42744614576441 -22.14599558515562, -20.45917099079353 -22.14128964893872, -20.69715687888937 -22.08167728726117, -20.92815376666594 -21.99902527920887, -21.14993702781821 -21.89412960880153, -21.36037076830222 -21.76800047868701, -21.55742839616233 -21.62185258133749, -21.73921213871958 -21.45709340089702, -21.90397131916006 -21.27530965833976, -22.05011921650958 -21.07825203047966, -22.1762483466241 -20.86781828999564, -22.28114401703143 -20.64603502884338, -22.36379602508374 -20.41503814106681, -22.4234083867613 -20.17705225297097, -22.45940700243371 -19.93436929875455, -22.47144518575322 -19.68932644793065, -22.46272989236197 -19.51192257546279, -22.48179191062821 -19.38341688656973, -22.49383009394772 -19.13837403574583, -22.48179191062821 -18.89333118492193, -22.4457932949558 -18.65064823070551, -22.38618093327824 -18.41266234260967, -22.3612750894556 -18.34305517218451, -22.39279909447611 -18.21720428958194, -22.42879771014853 -17.97452133536552, -22.44083589346804 -17.72947848454162, -22.42879771014853 -17.48443563371772, -22.39279909447611 -17.2417526795013, -22.33318673279856 -17.00376679140546, -22.29704609402757 -16.90276047256235, -22.3734870679685 -16.68912226225063, -22.43309942964606 -16.4511363741548, -22.46909804531847 -16.20845341993838, -22.48113622863798 -15.96341056911447, -22.46909804531847 -15.71836771829057, -22.43309942964606 -15.47568476407415, -22.40572505302204 -15.36640012664985, -22.42770850858644 -15.21819970725584, -22.43543587636467 -15.18735032582566, -22.47143449203709 -14.94466737160924, -22.48347267535659 -14.69962452078534, -22.47143449203709 -14.45458166996143, -22.43543587636467 -14.21189871574502, -22.37582351468712 -13.97391282764918, -22.29317150663481 -13.74291593987261, -22.29056292959623 -13.73740056711855, -22.29289905870317 -13.68984756671441, -22.29252178711778 -13.68216802717211, -22.31377473535278 -13.62277001599185, -22.37338709703034 -13.38478412789601, -22.40938571270275 -13.14210117367959, -22.42142389602226 -12.89705832285569, -22.40938571270275 -12.65201547203179, -22.37338709703034 -12.40933251781537, -22.31377473535278 -12.17134662971954, -22.23112272730048 -11.94034974194297, -22.19817821472779 -11.87069442245198, -22.19792766193782 -11.8655943032475, -22.16192904626541 -11.62291134903108, -22.10231668458785 -11.38492546093525, -22.01966467653555 -11.15392857315868, -21.99191048529292 -11.09524726609872, -21.92842458012701 -10.91781604746789, -21.8468060799781 -10.74524822781346, -21.92173834994376 -10.5868172541232, -22.00439035799606 -10.35582036634663, -22.01967276381155 -10.29480958237682, -22.06069364785215 -10.23949932305483, -22.18682277796667 -10.02906558257082, -22.291718448374 -9.807282321418555, -22.37437045642631 -9.576285433641985, -22.43398281810386 -9.33829954554615, -22.46998143377628 -9.09561659132973, -22.48201961709579 -8.850573740505828, -22.46998143377628 -8.605530889681926, -22.4573686685416 -8.520502533151651, -22.45836137069585 -8.500295616589442, -22.44973433808717 -8.324688333623628, -22.46112672765752 -8.24788708155117, -22.47316491097703 -8.002844230727268, -22.46112672765752 -7.757801379903367, -22.4251281119851 -7.515118425686947, -22.36551575030755 -7.277132537591112, -22.28286374225524 -7.046135649814543, -22.27337292135948 -7.026068995003135, -22.26191986068643 -6.792936589265861, -22.23700130787304 -6.624949351462579, -22.27702191722613 -6.465178122962197, -22.31302053289855 -6.222495168745778, -22.32505871621806 -5.977452317921876, -22.31302053289855 -5.732409467097974, -22.29913718581248 -5.638815543489387, -22.30871515529535 -5.443851495767794, -22.29667697197584 -5.198808644943893, -22.29060748755867 -5.157891504620128, -22.33815811338089 -5.024996408232262, -22.39777047505845 -4.787010520136427, -22.41659300653852 -4.660119320014077, -22.42566673888573 -4.623894949929971, -22.46166535455815 -4.381211995713552, -22.47370353787766 -4.13616914488965, -22.46166535455815 -3.891126294065749, -22.42631024597718 -3.652781512278879, -22.4441467206235 -3.532537767370365, -22.456184903943 -3.287494916546463, -22.4441467206235 -3.042452065722562, -22.40814810495108 -2.799769111506142, -22.40429375712431 -2.784381692441201, -22.4058295706438 -2.753119490067372, -22.42652472864004 -2.613604067413182, -22.43856291195954 -2.36856121658928, -22.42889752836875 -2.171817813823874, -22.46220332702011 -1.947288357391422, -22.47424151033962 -1.702245506567521, -22.46220332702011 -1.457202655743619, -22.42620471134769 -1.214519701527199, -22.36718807520162 -0.9789120830667674, -22.35689086573897 -0.7693075692219906, -22.32089225006656 -0.5266246150055711, -22.261279888389 -0.2886387269097357, -22.20425046928654 -0.1292521779944437, -22.23865998358758 -0.03308402793069509, -22.29827234526513 0.2049018601651402, -22.33427096093755 0.4475848143815596, -22.34532001016119 0.6724933781402493, -22.35146943767771 0.7139494510634626, -22.36350762099722 0.9589923018873644, -22.3592771699918 1.045105110367362, -22.38658792514858 1.154135756656995, -22.422586540821 1.396818710873414, -22.43462472414051 1.641861561697316, -22.422586540821 1.886904412521218, -22.38658792514858 2.129587366737637, -22.37396184882762 2.1799934889219, -22.38695198811661 2.216298496123226, -22.44656434979417 2.454284384219061, -22.48256296546658 2.69696733843548, -22.49460114878609 2.942010189259382, -22.48256296546658 3.187053040083284, -22.44656434979417 3.429735994299703, -22.38695198811661 3.667721882395539, -22.38282310228573 3.679261345251841, -22.40482289476282 3.827571899165153, -22.41686107808233 4.072614749989055, -22.40482289476282 4.317657600812956, -22.36882427909041 4.560340555029376, -22.30921191741285 4.798326443125212, -22.30467603942607 4.811003372857128, -22.36363753509564 4.975789714039571, -22.42324989677319 5.213775602135406, -22.45924851244561 5.456458556351826, -22.47128669576512 5.701501407175727, -22.45924851244561 5.946544257999629, -22.42520472119385 6.176048856423258, -22.43263431641783 6.22613511901725, -22.44467249973734 6.471177969841151, -22.43263431641783 6.716220820665053, -22.39663570074542 6.958903774881473, -22.39454427325957 6.967253221432506, -22.394861026681 6.969388599547307, -22.4068992100005 7.214431450371209, -22.394861026681 7.459474301195111, -22.36111420259841 7.686976909581786, -22.37179943577599 7.904479827593563, -22.35976125245649 8.149522678417465, -22.32376263678407 8.392205632633884, -22.26415027510652 8.630191520729721, -22.2200347057179 8.75348627752272, -22.21708918363268 8.813443756967004, -22.18109056796027 9.056126711183422, -22.12147820628271 9.294112599279259, -22.03882619823041 9.525109487055827, -22.00373838951193 9.599296425506701, -22.04396671166407 9.711727054073364, -22.05359014051572 9.732074084850684, -22.13624214856803 9.963070972627253, -22.19585451024558 10.20105686072309, -22.231853125918 10.44373981493951, -22.2438913092375 10.68878266576341, -22.231853125918 10.93382551658731, -22.19678075951196 11.1702642054589, -22.25477895783326 11.29289109286717, -22.33743096588557 11.52388798064374, -22.39704332756312 11.76187386873957, -22.43304194323554 12.00455682295599, -22.44508012655504 12.2495996737799, -22.43304194323554 12.4946425246038, -22.39704332756312 12.73732547882022, -22.33743096588557 12.97531136691605, -22.25477895783326 13.20630825469262, -22.14988328742593 13.42809151584489, -22.10462297699719 13.50360378180867, -22.16716011951175 13.67838338646343, -22.22677248118931 13.91636927455927, -22.26277109686172 14.15905222877569, -22.26462335331059 14.19675577495375, -22.29302006696381 14.31012181058106, -22.32901868263623 14.55280476479748, -22.34105686595574 14.79784761562138, -22.33192658845886 14.98369868361621, -22.39050818812954 15.21756953911278, -22.42650680380195 15.4602524933292, -22.43547952265877 15.64289638152731, -22.44403823256925 15.6770646667903, -22.48003684824166 15.91974762100672, -22.49207503156117 16.16479047183062, -22.48003684824166 16.40983332265453, -22.44403823256925 16.65251627687095, -22.40636946919279 16.80289840992767, -22.41197150930309 16.84066429670454, -22.4240096926226 17.08570714752844, -22.41197150930309 17.33074999835235, -22.38181414347826 17.53405444473314, -22.38305833385616 17.55938052168966, -22.37260135853582 17.7722371442781, -22.37766358477907 17.80636390156245, -22.38970176809858 18.05140675238635, -22.37766358477907 18.29644960321025, -22.35761020545555 18.4316385054875, -22.35423385062678 18.50036578689496, -22.37025623714802 18.60837994304902, -22.38229442046752 18.85342279387292, -22.37025623714802 19.09846564469682, -22.3342576214756 19.34114859891324, -22.30537123841755 19.45646950438467, -22.32604178702352 19.5958190240056, -22.33807997034302 19.8408618748295, -22.32604178702352 20.0859047256534, -22.2900431713511 20.32858767986982, -22.23043080967355 20.56657356796565, -22.14777880162124 20.79757045574222, -22.04288313121391 21.01935371689449, -21.91675400109939 21.22978745737851, -21.77060610374987 21.42684508523861, -21.60584692330939 21.60862882779587, -21.42406318075214 21.77338800823634, -21.22700555289203 21.91953590558586, -21.01657181240802 22.04566503570039, -20.79478855125575 22.15056070610771, -20.56379166347918 22.23321271416002, -20.4307583865337 22.26653581530638, -20.41830449611981 22.27242606679497, -20.18730760834324 22.35507807484727, -19.9493217202474 22.41469043652483, -19.70663876603098 22.45068905219724, -19.46159591520708 22.46272723551675, -19.21655306438318 22.45068905219724, -18.97387011016676 22.41469043652483, -18.73588422207093 22.35507807484728, -18.64505406713305 22.32257852574262, -18.40782727181207 22.3820007445785, -18.16514431759565 22.41799936025091, -17.92010146677175 22.43003754357042, -17.67505861594785 22.41799936025091, -17.5503671284345 22.399503125313, -17.43587274407975 22.41648676288385, -17.19082989325585 22.42852494620336, -16.94578704243195 22.41648676288385, -16.89031477907391 22.40825822991765, -16.82115409860222 22.41851724775424, -16.57611124777833 22.43055543107375, -16.39788303796649 22.42179964058564, -16.35038438081903 22.43369743482768, -16.10770142660261 22.46969605050009, -15.86265857577871 22.4817342338196, -15.61761572495481 22.46969605050009, -15.37493277073839 22.43369743482768, -15.13694688264255 22.37408507315013, -14.90594999486599 22.29143306509782, -14.8206581025195 22.25109300434882, -14.71557451981399 22.22477093715091, -14.65976147368973 22.20480070992366, -14.48458465159365 22.1788156830242, -14.45234634580798 22.17074040780624, -14.29831807419653 22.20932248134571, -14.05563511998011 22.24532109701812, -14.02162334345316 22.24699198845396, -13.99875298466096 22.2527207151063, -13.86995584245114 22.27182596638811, -13.81075298923094 22.29300908598844, -13.57276710113511 22.352621447666, -13.33008414691869 22.38862006333841, -13.08504129609479 22.40065824665792, -12.83999844527089 22.38862006333841, -12.60371436525269 22.35357063098932, -12.54382727719349 22.37499857372977, -12.30584138909765 22.43461093540733, -12.06315843488124 22.47060955107974, -11.81811558405734 22.48264773439925, -11.57307273323344 22.47060955107974, -11.33038977901702 22.43461093540733, -11.29538315086152 22.42584223153411, -11.23826008938479 22.42864850759365, -10.99321723856089 22.41661032427414, -10.75053428434447 22.38061170860173, -10.51254839624864 22.32099934692418, -10.33580272181398 22.25775873339386, -10.18534084118114 22.31159485512403, -9.947354953085307 22.37120721680159, -9.704671998868889 22.407205832474, -9.459629148044989 22.41924401579351, -9.214586297221089 22.407205832474, -9.04471806358278 22.38200826028587, -9.005397594027519 22.38393995108657, -8.793185646901277 22.43709627663851, -8.550502692684859 22.47309489231092, -8.305459841860959 22.48513307563043, -8.060416991037059 22.47309489231092, -7.81773403682064 22.43709627663851, -7.624786122499572 22.38876534010497, -7.42410576579648 22.39862413384041, -7.179062914972579 22.3865859505209, -6.93637996075616 22.35058733484848, -6.698394072660326 22.29097497317093, -6.541298596980119 22.23476531317993, -6.535699926618456 22.2350403582177, -6.290657075794555 22.22300217489819, -6.047974121578137 22.18700355922577, -6.045368531132135 22.18635089279545, -5.849769324545464 22.23534594346918, -5.740285956380461 22.25158626700496, -5.519323966714309 22.30693436411426, -5.276641012497891 22.34293297978667, -5.03159816167399 22.35497116310618, -4.78655531085009 22.34293297978667, -4.543872356633671 22.30693436411426, -4.462919229365399 22.28665666134685, -4.385824222448885 22.30596795527529, -4.143141268232466 22.34196657094771, -3.898098417408566 22.35400475426722, -3.653055566584665 22.34196657094771, -3.410372612368247 22.30596795527529, -3.383074108523836 22.29913003602953, -3.198321286899955 22.32653552827561, -2.953278436076054 22.33857371159512, -2.765340328481469 22.32934090441736, -2.64678250665151 22.37176157137471, -2.408796618555676 22.43137393305226, -2.166113664339258 22.46737254872468, -1.921070813515357 22.47941073204419, -1.676027962691456 22.46737254872468, -1.433345008475038 22.43137393305226, -1.195359120379203 22.37176157137471, -1.142651755126477 22.35290257453187, -0.9413867209710468 22.32304772693349, -0.7244596559357803 22.26871032582958, -0.5518773903080429 22.27718874886595, -0.3068345394841422 22.26515056554645, -0.0641515852677238 22.22915194987403, -0.03697761262200187 22.22234522406968, 0.0234066550944344 22.23747069573335, 0.2660896093108527 22.27346931140577, 0.5111324601347533 22.28550749472527, 0.756175310958654 22.27346931140577, 0.9988582651750725 22.23747069573335, 1.124606770200215 22.205972334961, 1.299512951183388 22.28869679765171, 1.530509838959956 22.37134880570402, 1.540541675798155 22.37386165001876, 1.580150144942097 22.38803378689097, 1.818136033037931 22.44764614856852, 2.06081898725435 22.48364476424094, 2.305861838078251 22.49568294756045, 2.550904688902151 22.48364476424094, 2.585818149549957 22.47846584157736, 2.636750143146877 22.48096796997526, 2.881792993970778 22.46892978665575, 3.124475948187196 22.43293117098334, 3.362461836283031 22.37331880930579, 3.405605077979647 22.35788191059068, 3.646083997305915 22.36969588233315, 3.891126848129816 22.35765769901364, 4.133809802346234 22.32165908334122, 4.371795690442069 22.26204672166367, 4.602792578218637 22.17939471361137, 4.74349612212289 22.11284689350158, 4.862426595900769 22.16909681837858, 5.093423483677336 22.25174882643089, 5.33140937177317 22.31136118810844, 5.574092325989588 22.34735980378086, 5.71264440274838 22.35416643084103, 5.788609578672952 22.38134720540751, 6.026595466768787 22.44095956708507, 6.269278420985205 22.47695818275748, 6.514321271809106 22.48899636607699, 6.759364122633007 22.47695818275748, 7.002047076849425 22.44095956708507, 7.045062493122757 22.43018476622139, 7.172998475183696 22.44916227646209, 7.418041326007597 22.4612004597816, 7.663084176831497 22.44916227646209, 7.905767131047916 22.41316366078968, 8.14375301914375 22.35355129911213, 8.374749906920318 22.27089929105982, 8.502525895102208 22.21046574944508, 8.674222684091824 22.14903165601327, 8.730173203256816 22.12256903125539, 8.755476828124921 22.12890725933043, 8.928144125486533 22.15452003340014, 9.056924723896049 22.21542872026604, 9.287921611672617 22.29808072831835, 9.525907499768453 22.35769308999591, 9.768590453984871 22.39369170566832, 10.01363330480877 22.40572988898783, 10.25867615563267 22.39369170566832, 10.38434897519156 22.37504990387232, 10.54562876847384 22.38297307204775, 10.79067161929774 22.37093488872825, 11.03335457351416 22.33493627305583, 11.27134046160999 22.27532391137828, 11.50233734938656 22.19267190332598, 11.5620735362037 22.1644187911154, 11.62238858930415 22.1614557025629, 11.65303800255386 22.15690929158103, 11.69067400012796 22.15875822957978, 11.93571685095186 22.14672004626027, 12.17839980516828 22.11072143058786, 12.41638569326412 22.05110906891031, 12.60921408285645 21.98211396788231, 12.61413707018288 21.98444236747987, 12.84513395795945 22.06709437553218, 13.08311984605528 22.12670673720973, 13.3258028002717 22.16270535288215, 13.5708456510956 22.17474353620165, 13.8158885019195 22.16270535288215, 14.0115966916425 22.13367478529024, 14.24606942960151 22.19240714866933, 14.48875238381793 22.22840576434175, 14.73379523464183 22.24044394766126, 14.83509011495141 22.23546764929387, 14.84302222492603 22.23830580362489, 15.08100811302187 22.29791816530244, 15.32369106723829 22.33391678097486, 15.56873391806219 22.34595496429436, 15.81377676888609 22.33391678097486, 16.05645972310251 22.29791816530244, 16.19915562030759 22.26217470377977, 16.35886794836413 22.31932068852286, 16.59685383645996 22.37893305020042, 16.83953679067638 22.41493166587283, 17.08457964150028 22.42696984919234, 17.32962249232418 22.41493166587283, 17.35406316190014 22.41130623501518, 17.36686412505037 22.41193510600877, 17.61190697587427 22.39989692268926, 17.85458993009069 22.36389830701685, 18.01708231883724 22.3231960825055, 18.18753309746713 22.38418434630179, 18.42551898556296 22.44379670797935, 18.66820193977938 22.47979532365176, 18.91324479060328 22.49183350697127, 19.15828764142718 22.47979532365176, 19.4009705956436 22.44379670797935, 19.63895648373943 22.38418434630179, 19.869953371516 22.30153233824949, 19.96551028205333 22.25633728547234, 19.9853426039062 22.24924116724643, 20.20712586505847 22.1443454968391, 20.41755960554248 22.01821636672458, 20.61461723340259 21.87206846937505, 20.79640097595984 21.70730928893459, 20.96116015640032 21.52552554637733, 20.97836787083578 21.50232362935326, 21.02993804195481 21.46407658377149, 21.1524925145701 21.35299968446598, 21.17995449857986 21.3365396046974, 21.37701212643996 21.19039170734787, 21.55879586899722 21.0256325269074, 21.72355504943769 20.84384878435015, 21.86970294678721 20.64679115649004, 21.99583207690174 20.43635741600603, 22.10072774730907 20.21457415485376, 22.18337975536138 19.9835772670772, 22.24299211703893 19.74559137898136, 22.27899073271135 19.50290842476495, 22.29102891603086 19.25786557394105, 22.29102891603086 19.25786557394103, 22.27899073271135 19.01282272311713, 22.25965275264398 18.88245665087605, 22.30806847593428 18.68917024884808, 22.3440670916067 18.44648729463166, 22.35610527492621 18.20144444380776, 22.35610527492621 18.20144444380774, 22.3440670916067 17.95640159298384, 22.32364979959007 17.81875939060629, 22.32637898934617 17.8111318162174, 22.38599135102372 17.57314592812157, 22.42198996669614 17.33046297390515, 22.43402815001565 17.08542012308125, 22.43402815001565 17.08542012308123, 22.42198996669614 16.84037727225733, 22.38599135102373 16.59769431804091, 22.32637898934617 16.35970842994507, 22.24372698129387 16.1287115421685, 22.13883131088654 15.90692828101623, 22.06904229209649 15.79049233750846, 22.10726844121714 15.70966993577967, 22.18992044926945 15.47867304800311, 22.24953281094701 15.24068715990727, 22.28553142661942 14.99800420569085, 22.29756960993893 14.75296135486695, 22.29756960993893 14.75296135486693, 22.28553142661942 14.50791850404303, 22.25769045232944 14.3202299009467, 22.29909198906613 14.15494570130185, 22.33509060473855 13.91226274708543, 22.34712878805806 13.66721989626153, 22.34712878805806 13.66721989626151, 22.33509060473855 13.42217704543761, 22.29909198906613 13.17949409122119, 22.23947962738858 12.94150820312535, 22.15682761933628 12.71051131534878, 22.1439806270021 12.68334863222938, 22.19843347304785 12.46596068515155, 22.23443208872027 12.22327773093513, 22.24647027203978 11.97823488011123, 22.24647027203978 11.97823488011121, 22.23443208872027 11.73319202928731, 22.22014157634299 11.63685322024689, 22.29170552965104 11.48554395377313, 22.37435753770335 11.25454706599656, 22.4339698993809 11.01656117790073, 22.46996851505332 10.77387822368431, 22.48200669837283 10.52883537286041, 22.48200669837283 10.52883537286039, 22.46996851505332 10.28379252203649, 22.43396989938091 10.04110956782007, 22.37435753770335 9.803123679724234, 22.34931049101803 9.733121873734932, 22.34643056114344 9.674499554410479, 22.31043194547102 9.431816600194061, 22.29103373003705 9.354374583175842, 22.30688482479567 9.310073741086473, 22.36649718647323 9.07208785299064, 22.40249580214564 8.829404898774222, 22.41453398546516 8.584362047950322, 22.41453398546516 8.5843620479503, 22.41010307540168 8.494168801603886, 22.43814828827776 8.382206035739104, 22.47414690395017 8.139523081522686, 22.48618508726968 7.894480230698785, 22.48618508726968 7.894480230698765, 22.47414690395017 7.649437379874864, 22.43814828827776 7.406754425658445, 22.3785359266002 7.16876853756261, 22.36084912120376 7.119337227936076, 22.36638055208554 7.082047349912735, 22.37841873540505 6.837004499088834, 22.37841873540505 6.837004499088813, 22.36638055208554 6.591961648264912, 22.35609034175698 6.522590685093183, 22.36222582230357 6.397700109463268, 22.36222582230357 6.397700109463248, 22.35018763898406 6.152657258639347, 22.31418902331165 5.909974304422928, 22.25457666163409 5.671988416327093, 22.17192465358179 5.440991528550525, 22.14187238184646 5.377451338525399, 22.13631459835018 5.264320056500067, 22.11639472283721 5.130031163807564, 22.14119387758969 5.060722169358346, 22.20080623926725 4.822736281262513, 22.20182312370297 4.815881003237257, 22.28678781110266 4.636238265065981, 22.36943981915496 4.405241377289414, 22.42905218083252 4.167255489193581, 22.46505079650493 3.924572534977163, 22.47708897982444 3.679529684153262, 22.47708897982444 3.679529684153241, 22.46505079650494 3.43448683332934, 22.42905218083252 3.191803879112921, 22.42622722872951 3.18052603813927, 22.41556802494946 2.963552960686345, 22.37956940927705 2.720870006469926, 22.37655704668347 2.708843980878516, 22.37665731548945 2.70816802349524, 22.38869549880896 2.463125172671339, 22.38869549880896 2.463125172671319, 22.37665731548946 2.218082321847417, 22.34065869981704 1.975399367630999, 22.31304697431726 1.86516718037985, 22.32294718632245 1.837497941417382, 22.38255954800001 1.599512053321549, 22.41855816367242 1.356829099105131, 22.43059634699193 1.11178624828123, 22.43059634699193 1.111786248281209, 22.41855816367243 0.866743397457308, 22.38255954800001 0.6240604432408892, 22.37015764437406 0.5745492686213595, 22.37034038738471 0.5740385361211262, 22.42995274906226 0.3360526480252923, 22.46595136473468 0.09336969380887428, 22.46983284362373 0.0143603759458221, 22.47762299880658 -0.03815658445019221, 22.48966118212609 -0.2831994352740928, 22.48966118212609 -0.2831994352741134, 22.47762299880658 -0.5282422860980147, 22.44162438313417 -0.7709252403144335, 22.38201202145661 -1.008911128410269, 22.33733720919316 -1.1337688643328, 22.35960416230565 -1.222663524140609, 22.39560277797807 -1.465346478357027, 22.40764096129758 -1.710389329180928, 22.40764096129758 -1.710389329180948, 22.39560277797807 -1.95543218000485, 22.35960416230566 -2.198115134221269, 22.2999918006281 -2.436101022317104, 22.2173397925758 -2.667097910093672, 22.12083454788258 -2.871141106569248, 22.10890457508578 -3.113981281601384, 22.09753928949359 -3.190599813495125, 22.11425511370344 -3.225942454346874, 22.19690712175575 -3.456939342123441, 22.2565194834333 -3.694925230219274, 22.27796733187449 -3.83951487968404, 22.30329211813286 -3.893059641470262, 22.38594412618517 -4.124056529246829, 22.44555648786272 -4.362042417342662, 22.48155510353514 -4.604725371559081, 22.49359328685465 -4.849768222382981, 22.49359328685465 -4.849768222383002, 22.48155510353514 -5.094811073206903, 22.46639370225972 -5.197020938304527, 22.4742428718067 -5.35679445490105, 22.4742428718067 -5.35679445490107, 22.47305251707211 -5.381024682163306, 22.47387421054751 -5.386564089619583, 22.48591239386703 -5.631606940443484, 22.48591239386703 -5.631606940443504, 22.47387421054752 -5.876649791267405, 22.4378755948751 -6.119332745483824, 22.37826323319755 -6.357318633579659, 22.37581970840857 -6.364147827869776, 22.33416054986185 -6.530460511431846, 22.25150854180955 -6.761457399208414, 22.14661287140222 -6.983240660360684, 22.14070790264234 -6.993092505548669, 22.14375134269476 -7.001598350679505, 22.20336370437232 -7.239584238775338, 22.23936232004473 -7.482267192991756, 22.25140050336424 -7.727310043815657, 22.25140050336424 -7.727310043815677, 22.23936232004474 -7.972352894639578, 22.20336370437232 -8.215035848855997, 22.17904866103241 -8.312106943180988, 22.25649042501777 -8.528542174291447, 22.31610278669532 -8.76652806238728, 22.32621521933611 -8.834700545738135, 22.32751997111001 -8.838347082660768, 22.38713233278757 -9.076332970756601, 22.42313094845998 -9.319015924973019, 22.4351691317795 -9.564058775796919, 22.4351691317795 -9.564058775796941, 22.42313094845999 -9.809101626620842, 22.38713233278757 -10.05178458083726, 22.32751997111002 -10.2897704689331, 22.24486796305771 -10.52076735670966, 22.13997229265038 -10.74255061786193, 22.04314691805991 -10.90409399590901, 22.03406561057082 -10.96531519812561, 22.06337928494946 -11.16293193877699, 22.06660106476485 -11.22851277350407, 22.08298043995721 -11.27429006049709, 22.14259280163477 -11.51227594859293, 22.17739333308725 -11.74688207506299, 22.23461413935799 -11.90680351528065, 22.29422650103554 -12.14478940337648, 22.33022511670796 -12.3874723575929, 22.34226330002747 -12.6325152084168, 22.34226330002747 -12.63251520841682, 22.33022511670796 -12.87755805924072, 22.30844502746572 -13.02438749425295, 22.34721627930011 -13.13274588408515, 22.40682864097767 -13.37073177218098, 22.44282725665008 -13.6134147263974, 22.45486543996959 -13.8584575772213, 22.45486543996959 -13.85845757722132, 22.44282725665009 -14.10350042804522, 22.40682864097767 -14.34618338226164, 22.40667909943321 -14.3467803855721, 22.41507202806971 -14.3802868348902, 22.45107064374212 -14.62296978910662, 22.46310882706163 -14.86801263993052, 22.46310882706163 -14.86801263993054, 22.45107064374212 -15.11305549075445, 22.41507202806971 -15.35573844497086, 22.37320910548004 -15.52286460019147, 22.36618663574583 -15.66581025551359, 22.33018802007341 -15.90849320973001, 22.30832089851852 -15.99579165248403, 22.31582939514044 -16.01677649474516, 22.375441756818 -16.254762382841, 22.41144037249041 -16.49744533705741, 22.42347855580992 -16.74248818788131, 22.42347855580992 -16.74248818788134, 22.41144037249041 -16.98753103870524, 22.375441756818 -17.23021399292166, 22.31582939514044 -17.46819988101749, 22.311953937675 -17.47903105904116, 22.3018715319233 -17.68426314290183, 22.26587291625088 -17.92694609711825, 22.20998447691467 -18.15006525387409, 22.19944723477361 -18.36455574513298, 22.1634486191012 -18.6072386993494, 22.10383625742364 -18.84522458744524, 22.04941193378315 -18.99733038228982, 22.04364672206227 -19.11468396282544, 22.00764810638986 -19.35736691704186, 21.97709163753492 -19.47935517875256, 21.97514755279599 -19.51892793271611, 21.93914893712358 -19.76161088693253, 21.87953657544602 -19.99959677502837, 21.79688456739372 -20.23059366280494, 21.69198889698639 -20.45237692395721, 21.64536097446595 -20.53017091284831, 21.58631018238545 -20.69520682078059, 21.48141451197812 -20.91699008193286, 21.35528538186359 -21.12742382241687, 21.20913748451407 -21.32448145027698, 21.0443783040736 -21.50626519283423, 20.86259456151634 -21.67102437327471, 20.66553693365623 -21.81717227062423, 20.45510319317222 -21.94330140073875, 20.23331993201996 -22.04819707114608, 20.00232304424339 -22.13084907919839, 19.76433715614755 -22.19046144087594, 19.52165420193113 -22.22646005654836, 19.27661135110723 -22.23849823986787, 19.03156850028333 -22.22646005654836, 18.78888554606691 -22.19046144087594, 18.73887089664221 -22.17793342337652, 18.4973901430078 -22.18979661208253, 18.41784477514719 -22.18588879874579, 18.41349373531924 -22.18697867748596, 18.17081078110282 -22.22297729315838, 17.98787095563432 -22.23196455048102, 17.79768532119148 -22.27960357192466, 17.55500236697506 -22.31560218759708, 17.30995951615116 -22.32764037091659, 17.06491666532726 -22.31560218759708, 16.82223371111084 -22.27960357192466, 16.584247823015 -22.21999121024711, 16.4666967485392 -22.177930763253, 16.4099384081795 -22.1695114587847, 16.28838315841296 -22.13906345377539, 16.17480211986003 -22.19278328422008, 15.94380523208346 -22.27543529227239, 15.70581934398762 -22.33504765394994, 15.46313638977121 -22.37104626962236, 15.2180935389473 -22.38308445294187, 14.9730506881234 -22.37104626962236, 14.73036773390698 -22.33504765394994, 14.65305301275748 -22.31568132447116, 14.45362419243909 -22.3452637954767, 14.20858134161519 -22.35730197879621, 13.96353849079129 -22.3452637954767, 13.73523415567763 -22.31139804646833, 13.59984162375042 -22.33148163139707, 13.35479877292652 -22.34351981471658, 13.10975592210262 -22.33148163139707, 12.8670729678862 -22.29548301572466, 12.62908707979036 -22.2358706540471, 12.61296722408551 -22.23010287744914, 12.51509107260605 -22.26512352442874, 12.27710518451022 -22.3247358861063, 12.0344222302938 -22.36073450177871, 11.7893793794699 -22.37277268509822, 11.544336528646 -22.36073450177871, 11.42614034228609 -22.34320175375175, 11.41367609013224 -22.34505065090392, 11.17312139811863 -22.35686834511981, 11.0505742524468 -22.38756480711927, 10.96704756934117 -22.39995482014355, 10.89076207090825 -22.41906334275269, 10.64807911669183 -22.4550619584251, 10.40303626586793 -22.46710014174461, 10.15799341504403 -22.4550619584251, 9.915310460827609 -22.41906334275269, 9.678390165997076 -22.35971789829296, 9.461434530251323 -22.39190022677332, 9.216391679427421 -22.40393841009282, 8.971348828603521 -22.39190022677332, 8.859745401813472 -22.37534542224775, 8.640809946866888 -22.43018589883542, 8.39812699265047 -22.46618451450784, 8.153084141826568 -22.47822269782734, 7.908041291002667 -22.46618451450784, 7.665358336786248 -22.43018589883542, 7.654227093690167 -22.42739766758913, 7.631127550771891 -22.42853247536382, 7.386084699947989 -22.41649429204432, 7.14340174573157 -22.3804956763719, 6.961547070081421 -22.33494345147172, 6.84664652751557 -22.31789956602152, 6.757417223308805 -22.33113548297839, 6.512374372484904 -22.3431736662979, 6.267331521661002 -22.33113548297839, 6.024648567444583 -22.29513686730598, 5.786662679348748 -22.23552450562843, 5.679434149468312 -22.19715752414906, 5.639137942656076 -22.19517789845072, 5.527756450060979 -22.2116997821483, 5.309290253954825 -22.22243233814412, 5.171949898293681 -22.28738948868023, 4.940953010517113 -22.37004149673253, 4.702967122421279 -22.42965385841009, 4.46028416820486 -22.4656524740825, 4.215241317380959 -22.47769065740201, 3.970198466557057 -22.4656524740825, 3.750904670430335 -22.43312331227301, 3.67246061444501 -22.44475938878411, 3.427417763621108 -22.45679757210362, 3.182374912797207 -22.44475938878411, 2.939691958580788 -22.40876077311169, 2.701706070484953 -22.34914841143414, 2.470709182708385 -22.26649640338184, 2.400539054657536 -22.233308404494, 2.382213028549373 -22.23058999531359, 2.144227140453538 -22.17097763363604, 1.91323025267697 -22.08832562558374, 1.772685063718212 -22.02185270178525, 1.740138581807164 -22.04599081787381, 1.529704841323152 -22.17211994798834, 1.307921580170883 -22.27701561839567, 1.076924692394315 -22.35966762644798, 0.8389388042984798 -22.41927998812553, 0.5962558500820608 -22.45527860379795, 0.3512129992581597 -22.46731678711745, 0.1061701484342584 -22.45527860379795, -0.04851836590371944 -22.43233273026278, -0.2461837018222049 -22.42262205500048, -0.4888666560386239 -22.38662343932807, -0.726852544134459 -22.32701107765052, -0.9578494319110273 -22.24435906959821, -1.125708636819748 -22.16496757836726, -1.139764547714639 -22.17161552911361, -1.370761435491207 -22.25426753716592, -1.608747323587042 -22.31387989884347, -1.851430277803461 -22.34987851451589, -2.096473128627362 -22.3619166978354, -2.341515979451263 -22.34987851451589, -2.455727455302357 -22.33293684245731, -2.55442301821249 -22.34757694624723, -2.617898317366901 -22.37028877144683, -2.855884205462736 -22.42990113312439, -3.098567159679154 -22.4658997487968, -3.343610010503056 -22.47793793211631, -3.588652861326957 -22.4658997487968, -3.831335815543376 -22.42990113312439, -3.907954521318272 -22.41070914642104, -3.975896008872092 -22.41404689767321, -4.183715500617316 -22.44487400721096, -4.428758351441217 -22.45691219053047, -4.673801202265119 -22.44487400721096, -4.916484156481538 -22.40887539153854, -5.020084557130864 -22.38292484210529, -5.020419078409338 -22.38304453573263, -5.258404966505172 -22.44265689741019, -5.501087920721591 -22.4786555130826, -5.746130771545492 -22.49069369640211, -5.991173622369394 -22.4786555130826, -6.123693431593027 -22.45899805631302, -6.264189488772653 -22.46590018500729, -6.509232339596555 -22.45386200168778, -6.751915293812974 -22.41786338601537, -6.989901181908809 -22.35825102433781, -7.220898069685378 -22.27559901628551, -7.347294079158904 -22.2158181559913, -7.532152849094219 -22.18839694779783, -7.598927497924632 -22.17167076899446, -7.804850114037394 -22.22325169913918, -8.047533068253813 -22.2592503148116, -8.292575919077715 -22.27128849813111, -8.537618769901615 -22.2592503148116, -8.565029213837116 -22.25518435954156, -8.633110179045801 -22.27954411840584, -8.871096067141636 -22.3391564800834, -9.113779021358054 -22.37515509575582, -9.358821872181956 -22.38719327907532, -9.603864723005856 -22.37515509575582, -9.846547677222276 -22.3391564800834, -10.08453356531811 -22.27954411840584, -10.09791748181934 -22.27475527650811, -10.14016295582498 -22.29473589765361, -10.37115984360155 -22.37738790570592, -10.60914573169738 -22.43700026738347, -10.8518286859138 -22.47299888305589, -11.0968715367377 -22.48503706637539, -11.3419143875616 -22.47299888305589, -11.58459734177802 -22.43700026738347, -11.75310292370707 -22.3947918163908, -11.90532691377749 -22.43292194093173, -12.1480098679939 -22.46892055660414, -12.39305271881781 -22.48095873992365, -12.63809556964171 -22.46892055660414, -12.88077852385813 -22.43292194093173, -13.11876441195396 -22.37330957925418, -13.20218180754802 -22.34346235785346, -13.35693885800207 -22.35106508422189, -13.60198170882597 -22.33902690090238, -13.84466466304239 -22.30302828522996, -14.08265055113823 -22.24341592355241, -14.31364743891479 -22.16076391550011, -14.50430349127707 -22.07059031842225))";

		// epl result for union
		String eplWKT = "MULTIPOLYGON (((-15.90174522590254 -22.49823229650554, -15.65670237507864 -22.48619411318603, -15.41401942086222 -22.45019549751362, -15.17603353276639 -22.39058313583606, -14.94503664498982 -22.30793112778376, -14.72325338383755 -22.20303545737643, -14.51281964335354 -22.0769063272619, -14.50430349127707 -22.07059031842225, -14.31364743891479 -22.16076391550011, -14.08265055113823 -22.24341592355241, -13.84466466304239 -22.30302828522996, -13.60198170882597 -22.33902690090238, -13.35693885800207 -22.35106508422189, -13.20218180754802 -22.34346235785346, -13.11876441195396 -22.37330957925418, -12.88077852385813 -22.43292194093173, -12.63809556964171 -22.46892055660414, -12.39305271881781 -22.48095873992365, -12.1480098679939 -22.46892055660414, -11.90532691377749 -22.43292194093173, -11.75310292370707 -22.3947918163908, -11.58459734177802 -22.43700026738347, -11.3419143875616 -22.47299888305589, -11.0968715367377 -22.48503706637539, -10.8518286859138 -22.47299888305589, -10.60914573169738 -22.43700026738347, -10.37115984360155 -22.37738790570592, -10.14016295582498 -22.29473589765361, -10.09791748181934 -22.27475527650811, -10.08453356531811 -22.27954411840584, -9.846547677222276 -22.3391564800834, -9.603864723005856 -22.37515509575582, -9.358821872181956 -22.38719327907532, -9.113779021358054 -22.37515509575582, -8.871096067141636 -22.3391564800834, -8.633110179045801 -22.27954411840584, -8.565029213837116 -22.25518435954156, -8.537618769901615 -22.2592503148116, -8.292575919077715 -22.27128849813111, -8.047533068253813 -22.2592503148116, -7.804850114037394 -22.22325169913918, -7.598927497924632 -22.17167076899446, -7.532152849094219 -22.18839694779783, -7.347294079158904 -22.2158181559913, -7.220898069685378 -22.27559901628551, -6.989901181908809 -22.35825102433781, -6.751915293812974 -22.41786338601537, -6.509232339596555 -22.45386200168778, -6.264189488772653 -22.46590018500729, -6.123693431593027 -22.45899805631302, -5.991173622369394 -22.4786555130826, -5.746130771545492 -22.49069369640211, -5.501087920721591 -22.4786555130826, -5.258404966505172 -22.44265689741019, -5.020419078409338 -22.38304453573263, -5.020084557130864 -22.38292484210529, -4.916484156481538 -22.40887539153854, -4.673801202265119 -22.44487400721096, -4.428758351441217 -22.45691219053047, -4.183715500617316 -22.44487400721096, -3.975896008872092 -22.41404689767321, -3.907954521318273 -22.41070914642104, -3.831335815543376 -22.42990113312439, -3.588652861326957 -22.4658997487968, -3.343610010503056 -22.47793793211631, -3.098567159679154 -22.4658997487968, -2.855884205462736 -22.42990113312439, -2.617898317366901 -22.37028877144683, -2.55442301821249 -22.34757694624723, -2.455727455302357 -22.33293684245731, -2.341515979451263 -22.34987851451589, -2.096473128627362 -22.3619166978354, -1.851430277803461 -22.34987851451589, -1.608747323587042 -22.31387989884347, -1.370761435491207 -22.25426753716592, -1.139764547714639 -22.17161552911361, -1.125708636819748 -22.16496757836726, -0.9578494319110273 -22.24435906959821, -0.726852544134459 -22.32701107765052, -0.4888666560386239 -22.38662343932807, -0.2461837018222049 -22.42262205500048, -0.04851836590371948 -22.43233273026278, 0.1061701484342584 -22.45527860379795, 0.3512129992581597 -22.46731678711745, 0.5962558500820608 -22.45527860379795, 0.8389388042984798 -22.41927998812553, 1.076924692394315 -22.35966762644798, 1.307921580170883 -22.27701561839567, 1.529704841323152 -22.17211994798834, 1.740138581807164 -22.04599081787381, 1.772685063718212 -22.02185270178525, 1.91323025267697 -22.08832562558374, 2.144227140453538 -22.17097763363604, 2.382213028549373 -22.23058999531359, 2.400539054657536 -22.233308404494, 2.470709182708385 -22.26649640338184, 2.701706070484953 -22.34914841143414, 2.939691958580788 -22.40876077311169, 3.182374912797207 -22.44475938878411, 3.427417763621108 -22.45679757210362, 3.67246061444501 -22.44475938878411, 3.750904670430335 -22.43312331227301, 3.970198466557057 -22.4656524740825, 4.215241317380959 -22.47769065740201, 4.46028416820486 -22.4656524740825, 4.702967122421279 -22.42965385841009, 4.940953010517113 -22.37004149673253, 5.171949898293681 -22.28738948868023, 5.309290253954825 -22.22243233814412, 5.527756450060979 -22.2116997821483, 5.63913794265608 -22.19517789845072, 5.679434149468313 -22.19715752414906, 5.786662679348748 -22.23552450562843, 6.024648567444583 -22.29513686730598, 6.267331521661002 -22.33113548297839, 6.512374372484904 -22.3431736662979, 6.757417223308805 -22.33113548297839, 6.846646527515573 -22.31789956602152, 6.961547070081421 -22.33494345147172, 7.14340174573157 -22.3804956763719, 7.386084699947989 -22.41649429204432, 7.631127550771891 -22.42853247536382, 7.654227093690167 -22.42739766758913, 7.665358336786248 -22.43018589883542, 7.908041291002667 -22.46618451450784, 8.153084141826568 -22.47822269782734, 8.39812699265047 -22.46618451450784, 8.640809946866888 -22.43018589883542, 8.859745401813472 -22.37534542224775, 8.971348828603521 -22.39190022677332, 9.216391679427421 -22.40393841009282, 9.461434530251323 -22.39190022677332, 9.678390165997076 -22.35971789829296, 9.915310460827609 -22.41906334275269, 10.15799341504403 -22.4550619584251, 10.40303626586793 -22.46710014174461, 10.64807911669183 -22.4550619584251, 10.89076207090825 -22.41906334275269, 10.96704756934117 -22.39995482014355, 11.0505742524468 -22.38756480711927, 11.17312139811863 -22.35686834511981, 11.41367609013224 -22.34505065090392, 11.42614034228609 -22.34320175375175, 11.544336528646 -22.36073450177871, 11.7893793794699 -22.37277268509822, 12.0344222302938 -22.36073450177871, 12.27710518451022 -22.3247358861063, 12.51509107260605 -22.26512352442874, 12.61296722408551 -22.23010287744914, 12.62908707979036 -22.2358706540471, 12.8670729678862 -22.29548301572466, 13.10975592210262 -22.33148163139707, 13.35479877292652 -22.34351981471658, 13.59984162375042 -22.33148163139707, 13.73523415567763 -22.31139804646833, 13.96353849079129 -22.3452637954767, 14.20858134161519 -22.35730197879621, 14.45362419243909 -22.3452637954767, 14.65305301275748 -22.31568132447116, 14.73036773390698 -22.33504765394994, 14.9730506881234 -22.37104626962236, 15.2180935389473 -22.38308445294187, 15.46313638977121 -22.37104626962236, 15.70581934398762 -22.33504765394994, 15.94380523208346 -22.27543529227239, 16.17480211986003 -22.19278328422008, 16.28838315841296 -22.13906345377539, 16.4099384081795 -22.1695114587847, 16.4666967485392 -22.177930763253, 16.584247823015 -22.21999121024711, 16.82223371111084 -22.27960357192466, 17.06491666532726 -22.31560218759708, 17.30995951615116 -22.32764037091659, 17.55500236697506 -22.31560218759708, 17.79768532119148 -22.27960357192466, 17.98787095563432 -22.23196455048102, 18.17081078110282 -22.22297729315838, 18.41349373531924 -22.18697867748596, 18.41784477514719 -22.18588879874579, 18.4973901430078 -22.18979661208253, 18.73887089664221 -22.17793342337652, 18.78888554606691 -22.19046144087594, 19.03156850028333 -22.22646005654836, 19.27661135110723 -22.23849823986787, 19.52165420193113 -22.22646005654836, 19.76433715614755 -22.19046144087594, 20.00232304424339 -22.13084907919839, 20.23331993201996 -22.04819707114608, 20.45510319317222 -21.94330140073875, 20.66553693365623 -21.81717227062423, 20.86259456151634 -21.67102437327471, 21.0443783040736 -21.50626519283423, 21.20913748451407 -21.32448145027698, 21.35528538186359 -21.12742382241687, 21.48141451197812 -20.91699008193286, 21.58631018238545 -20.69520682078059, 21.64536097446595 -20.53017091284831, 21.69198889698639 -20.45237692395721, 21.79688456739372 -20.23059366280494, 21.87953657544602 -19.99959677502837, 21.93914893712358 -19.76161088693253, 21.97514755279599 -19.51892793271611, 21.97709163753492 -19.47935517875256, 22.00764810638986 -19.35736691704186, 22.04364672206227 -19.11468396282544, 22.04941193378315 -18.99733038228982, 22.10383625742364 -18.84522458744524, 22.1634486191012 -18.6072386993494, 22.19944723477361 -18.36455574513298, 22.20998447691467 -18.15006525387409, 22.26587291625088 -17.92694609711825, 22.3018715319233 -17.68426314290183, 22.311953937675 -17.47903105904117, 22.31582939514044 -17.46819988101749, 22.375441756818 -17.23021399292166, 22.41144037249041 -16.98753103870524, 22.42347855580992 -16.74248818788132, 22.41144037249041 -16.49744533705741, 22.375441756818 -16.254762382841, 22.31582939514044 -16.01677649474516, 22.30832089851852 -15.99579165248403, 22.33018802007341 -15.90849320973001, 22.36618663574583 -15.66581025551359, 22.37320910548004 -15.52286460019147, 22.41507202806971 -15.35573844497086, 22.45107064374212 -15.11305549075445, 22.46310882706163 -14.86801263993053, 22.45107064374212 -14.62296978910662, 22.41507202806971 -14.3802868348902, 22.40667909943321 -14.3467803855721, 22.40682864097767 -14.34618338226164, 22.44282725665009 -14.10350042804522, 22.45486543996959 -13.85845757722131, 22.44282725665008 -13.6134147263974, 22.40682864097767 -13.37073177218098, 22.34721627930011 -13.13274588408515, 22.30844502746573 -13.02438749425295, 22.33022511670796 -12.87755805924072, 22.34226330002747 -12.63251520841681, 22.33022511670796 -12.3874723575929, 22.29422650103554 -12.14478940337648, 22.23461413935799 -11.90680351528065, 22.17739333308725 -11.74688207506299, 22.14259280163477 -11.51227594859293, 22.08298043995721 -11.27429006049709, 22.06660106476485 -11.22851277350407, 22.06337928494946 -11.16293193877699, 22.03406561057082 -10.96531519812561, 22.04314691805991 -10.90409399590901, 22.13997229265038 -10.74255061786193, 22.24486796305771 -10.52076735670966, 22.32751997111002 -10.2897704689331, 22.38713233278757 -10.05178458083726, 22.42313094845999 -9.809101626620842, 22.4351691317795 -9.56405877579693, 22.42313094845998 -9.319015924973019, 22.38713233278757 -9.076332970756601, 22.32751997111001 -8.838347082660768, 22.32621521933611 -8.834700545738135, 22.31610278669532 -8.76652806238728, 22.25649042501777 -8.528542174291447, 22.17904866103241 -8.312106943180988, 22.20336370437232 -8.215035848855997, 22.23936232004474 -7.972352894639578, 22.25140050336424 -7.727310043815667, 22.23936232004473 -7.482267192991756, 22.20336370437232 -7.239584238775338, 22.14375134269476 -7.001598350679505, 22.14070790264234 -6.993092505548669, 22.14661287140222 -6.983240660360684, 22.25150854180955 -6.761457399208414, 22.33416054986185 -6.530460511431846, 22.37581970840857 -6.364147827869776, 22.37826323319755 -6.357318633579659, 22.4378755948751 -6.119332745483824, 22.47387421054752 -5.876649791267405, 22.48591239386703 -5.631606940443493, 22.47387421054751 -5.386564089619583, 22.47305251707211 -5.381024682163304, 22.4742428718067 -5.35679445490106, 22.46639370225972 -5.197020938304531, 22.48155510353514 -5.094811073206903, 22.49359328685465 -4.849768222382991, 22.48155510353514 -4.604725371559081, 22.44555648786272 -4.362042417342662, 22.38594412618517 -4.124056529246829, 22.30329211813286 -3.893059641470262, 22.27796733187449 -3.83951487968404, 22.2565194834333 -3.694925230219274, 22.19690712175575 -3.456939342123441, 22.11425511370344 -3.225942454346874, 22.09753928949359 -3.190599813495125, 22.10890457508578 -3.113981281601384, 22.12083454788258 -2.87114110656925, 22.2173397925758 -2.667097910093672, 22.2999918006281 -2.436101022317104, 22.35960416230566 -2.198115134221269, 22.39560277797807 -1.95543218000485, 22.40764096129758 -1.710389329180938, 22.39560277797807 -1.465346478357027, 22.35960416230565 -1.222663524140609, 22.33733720919316 -1.1337688643328, 22.38201202145661 -1.008911128410269, 22.44162438313417 -0.7709252403144335, 22.47762299880658 -0.5282422860980147, 22.48966118212609 -0.2831994352741031, 22.47762299880658 -0.03815658445019221, 22.46983284362372 0.01436037594582373, 22.46595136473468 0.09336969380887428, 22.42995274906226 0.3360526480252923, 22.37034038738471 0.5740385361211262, 22.37015764437406 0.5745492686213597, 22.38255954800001 0.6240604432408892, 22.41855816367243 0.866743397457308, 22.43059634699193 1.11178624828122, 22.41855816367242 1.356829099105131, 22.38255954800001 1.599512053321549, 22.32294718632245 1.837497941417382, 22.31304697431726 1.86516718037985, 22.34065869981704 1.975399367630999, 22.37665731548946 2.218082321847417, 22.38869549880896 2.463125172671329, 22.37665731548945 2.70816802349524, 22.37655704668347 2.708843980878516, 22.37956940927705 2.720870006469926, 22.41556802494946 2.963552960686345, 22.42622722872951 3.180526038139268, 22.42905218083252 3.191803879112921, 22.46505079650494 3.43448683332934, 22.47708897982444 3.679529684153251, 22.46505079650493 3.924572534977163, 22.42905218083252 4.167255489193581, 22.36943981915496 4.405241377289414, 22.28678781110266 4.636238265065981, 22.20182312370297 4.815881003237257, 22.20080623926725 4.822736281262513, 22.14119387758969 5.060722169358346, 22.11639472283721 5.130031163807564, 22.13631459835018 5.264320056500067, 22.14187238184646 5.377451338525397, 22.17192465358179 5.440991528550525, 22.25457666163409 5.671988416327093, 22.31418902331165 5.909974304422928, 22.35018763898406 6.152657258639347, 22.36222582230357 6.397700109463258, 22.35609034175698 6.522590685093183, 22.36638055208554 6.591961648264912, 22.37841873540505 6.837004499088824, 22.36638055208554 7.082047349912735, 22.36084912120376 7.119337227936076, 22.3785359266002 7.16876853756261, 22.43814828827776 7.406754425658445, 22.47414690395017 7.649437379874864, 22.48618508726968 7.894480230698775, 22.47414690395017 8.139523081522686, 22.43814828827776 8.382206035739104, 22.41010307540168 8.494168801603886, 22.41453398546516 8.584362047950311, 22.40249580214564 8.829404898774222, 22.36649718647323 9.07208785299064, 22.30688482479567 9.310073741086473, 22.29103373003705 9.354374583175842, 22.31043194547102 9.431816600194061, 22.34643056114344 9.674499554410479, 22.34931049101803 9.73312187373493, 22.37435753770335 9.803123679724234, 22.43396989938091 10.04110956782007, 22.46996851505332 10.28379252203649, 22.48200669837283 10.5288353728604, 22.46996851505332 10.77387822368431, 22.4339698993809 11.01656117790073, 22.37435753770335 11.25454706599656, 22.29170552965104 11.48554395377313, 22.22014157634299 11.63685322024689, 22.23443208872027 11.73319202928731, 22.24647027203978 11.97823488011122, 22.23443208872027 12.22327773093513, 22.19843347304785 12.46596068515155, 22.1439806270021 12.68334863222938, 22.15682761933628 12.71051131534878, 22.23947962738858 12.94150820312535, 22.29909198906613 13.17949409122119, 22.33509060473855 13.42217704543761, 22.34712878805806 13.66721989626152, 22.33509060473855 13.91226274708543, 22.29909198906613 14.15494570130185, 22.25769045232944 14.3202299009467, 22.28553142661942 14.50791850404303, 22.29756960993893 14.75296135486694, 22.28553142661942 14.99800420569085, 22.24953281094701 15.24068715990727, 22.18992044926945 15.47867304800311, 22.10726844121714 15.70966993577967, 22.06904229209649 15.79049233750846, 22.13883131088654 15.90692828101623, 22.24372698129387 16.1287115421685, 22.32637898934617 16.35970842994507, 22.38599135102373 16.59769431804091, 22.42198996669614 16.84037727225733, 22.43402815001565 17.08542012308124, 22.42198996669614 17.33046297390515, 22.38599135102372 17.57314592812157, 22.32637898934617 17.8111318162174, 22.32364979959007 17.81875939060629, 22.3440670916067 17.95640159298384, 22.35610527492621 18.20144444380775, 22.3440670916067 18.44648729463166, 22.30806847593428 18.68917024884808, 22.25965275264398 18.88245665087605, 22.27899073271135 19.01282272311713, 22.29102891603086 19.25786557394104, 22.27899073271135 19.50290842476495, 22.24299211703893 19.74559137898136, 22.18337975536138 19.9835772670772, 22.10072774730907 20.21457415485376, 21.99583207690174 20.43635741600603, 21.86970294678721 20.64679115649004, 21.72355504943769 20.84384878435015, 21.55879586899722 21.0256325269074, 21.37701212643996 21.19039170734787, 21.17995449857986 21.3365396046974, 21.1524925145701 21.35299968446598, 21.02993804195481 21.46407658377149, 20.97836787083578 21.50232362935326, 20.96116015640032 21.52552554637733, 20.79640097595984 21.70730928893459, 20.61461723340259 21.87206846937505, 20.41755960554248 22.01821636672458, 20.20712586505847 22.1443454968391, 19.9853426039062 22.24924116724643, 19.96551028205333 22.25633728547234, 19.869953371516 22.30153233824949, 19.63895648373943 22.38418434630179, 19.4009705956436 22.44379670797935, 19.15828764142718 22.47979532365176, 18.91324479060328 22.49183350697127, 18.66820193977938 22.47979532365176, 18.42551898556296 22.44379670797935, 18.18753309746713 22.38418434630179, 18.01708231883724 22.3231960825055, 17.85458993009069 22.36389830701685, 17.61190697587427 22.39989692268926, 17.36686412505037 22.41193510600877, 17.35406316190014 22.41130623501518, 17.32962249232418 22.41493166587283, 17.08457964150028 22.42696984919234, 16.83953679067638 22.41493166587283, 16.59685383645996 22.37893305020042, 16.35886794836413 22.31932068852286, 16.19915562030759 22.26217470377977, 16.05645972310251 22.29791816530244, 15.81377676888609 22.33391678097486, 15.56873391806219 22.34595496429436, 15.32369106723829 22.33391678097486, 15.08100811302187 22.29791816530244, 14.84302222492603 22.23830580362489, 14.83509011495141 22.23546764929387, 14.73379523464183 22.24044394766126, 14.48875238381793 22.22840576434175, 14.24606942960151 22.19240714866933, 14.0115966916425 22.13367478529024, 13.8158885019195 22.16270535288215, 13.5708456510956 22.17474353620165, 13.3258028002717 22.16270535288215, 13.08311984605528 22.12670673720973, 12.84513395795945 22.06709437553218, 12.61413707018288 21.98444236747987, 12.60921408285645 21.98211396788231, 12.41638569326412 22.05110906891031, 12.17839980516828 22.11072143058786, 11.93571685095186 22.14672004626027, 11.69067400012796 22.15875822957978, 11.65303800255386 22.15690929158103, 11.62238858930415 22.1614557025629, 11.5620735362037 22.1644187911154, 11.50233734938656 22.19267190332598, 11.27134046160999 22.27532391137828, 11.03335457351416 22.33493627305583, 10.79067161929774 22.37093488872825, 10.54562876847384 22.38297307204775, 10.38434897519156 22.37504990387232, 10.25867615563267 22.39369170566832, 10.01363330480877 22.40572988898783, 9.768590453984871 22.39369170566832, 9.525907499768453 22.35769308999591, 9.287921611672617 22.29808072831835, 9.056924723896049 22.21542872026604, 8.928144125486533 22.15452003340014, 8.755476828124921 22.12890725933043, 8.730173203256818 22.12256903125539, 8.674222684091824 22.14903165601327, 8.502525895102208 22.21046574944508, 8.374749906920318 22.27089929105982, 8.14375301914375 22.35355129911213, 7.905767131047916 22.41316366078968, 7.663084176831497 22.44916227646209, 7.418041326007597 22.4612004597816, 7.172998475183696 22.44916227646209, 7.045062493122757 22.43018476622139, 7.002047076849425 22.44095956708507, 6.759364122633007 22.47695818275748, 6.514321271809106 22.48899636607699, 6.269278420985205 22.47695818275748, 6.026595466768787 22.44095956708507, 5.788609578672952 22.38134720540751, 5.71264440274838 22.35416643084103, 5.574092325989588 22.34735980378086, 5.33140937177317 22.31136118810844, 5.093423483677336 22.25174882643089, 4.862426595900769 22.16909681837858, 4.743496122122889 22.11284689350158, 4.602792578218637 22.17939471361137, 4.371795690442069 22.26204672166367, 4.133809802346234 22.32165908334122, 3.891126848129816 22.35765769901364, 3.646083997305915 22.36969588233315, 3.405605077979647 22.35788191059068, 3.362461836283031 22.37331880930579, 3.124475948187196 22.43293117098334, 2.881792993970778 22.46892978665575, 2.636750143146877 22.48096796997526, 2.585818149549957 22.47846584157736, 2.550904688902151 22.48364476424094, 2.305861838078251 22.49568294756045, 2.06081898725435 22.48364476424094, 1.818136033037931 22.44764614856852, 1.580150144942097 22.38803378689097, 1.540541675798155 22.37386165001876, 1.530509838959956 22.37134880570402, 1.299512951183388 22.28869679765171, 1.124606770200216 22.205972334961, 0.9988582651750725 22.23747069573335, 0.756175310958654 22.27346931140577, 0.5111324601347533 22.28550749472527, 0.2660896093108527 22.27346931140577, 0.0234066550944344 22.23747069573335, -0.03697761262200187 22.22234522406968, -0.0641515852677238 22.22915194987403, -0.3068345394841422 22.26515056554645, -0.5518773903080429 22.27718874886595, -0.7244596559357803 22.26871032582958, -0.9413867209710468 22.32304772693349, -1.142651755126477 22.35290257453187, -1.195359120379203 22.37176157137471, -1.433345008475038 22.43137393305226, -1.676027962691456 22.46737254872468, -1.921070813515357 22.47941073204419, -2.166113664339258 22.46737254872468, -2.408796618555676 22.43137393305226, -2.64678250665151 22.37176157137471, -2.765340328481469 22.32934090441736, -2.953278436076054 22.33857371159512, -3.198321286899955 22.32653552827561, -3.383074108523836 22.29913003602953, -3.410372612368247 22.30596795527529, -3.653055566584665 22.34196657094771, -3.898098417408566 22.35400475426722, -4.143141268232466 22.34196657094771, -4.385824222448885 22.30596795527529, -4.462919229365399 22.28665666134685, -4.543872356633671 22.30693436411426, -4.78655531085009 22.34293297978667, -5.03159816167399 22.35497116310618, -5.276641012497891 22.34293297978667, -5.519323966714309 22.30693436411426, -5.740285956380461 22.25158626700496, -5.849769324545464 22.23534594346918, -6.045368531132135 22.18635089279545, -6.047974121578137 22.18700355922577, -6.290657075794555 22.22300217489819, -6.535699926618456 22.2350403582177, -6.541298596980119 22.23476531317993, -6.698394072660326 22.29097497317093, -6.93637996075616 22.35058733484848, -7.179062914972579 22.3865859505209, -7.42410576579648 22.39862413384041, -7.624786122499572 22.38876534010497, -7.81773403682064 22.43709627663851, -8.060416991037059 22.47309489231092, -8.305459841860959 22.48513307563043, -8.550502692684859 22.47309489231092, -8.793185646901277 22.43709627663851, -9.005397594027517 22.38393995108657, -9.044718063582776 22.38200826028587, -9.214586297221089 22.407205832474, -9.459629148044989 22.41924401579351, -9.704671998868889 22.407205832474, -9.947354953085307 22.37120721680159, -10.18534084118114 22.31159485512403, -10.33580272181398 22.25775873339386, -10.51254839624864 22.32099934692418, -10.75053428434447 22.38061170860173, -10.99321723856089 22.41661032427414, -11.23826008938479 22.42864850759365, -11.29538315086152 22.42584223153411, -11.33038977901702 22.43461093540733, -11.57307273323344 22.47060955107974, -11.81811558405734 22.48264773439925, -12.06315843488124 22.47060955107974, -12.30584138909765 22.43461093540733, -12.54382727719349 22.37499857372977, -12.60371436525269 22.35357063098932, -12.83999844527089 22.38862006333841, -13.08504129609479 22.40065824665792, -13.33008414691869 22.38862006333841, -13.57276710113511 22.352621447666, -13.81075298923094 22.29300908598844, -13.86995584245114 22.27182596638811, -13.99875298466096 22.2527207151063, -14.02162334345316 22.24699198845396, -14.05563511998011 22.24532109701812, -14.29831807419653 22.20932248134571, -14.45234634580798 22.17074040780624, -14.48458465159365 22.1788156830242, -14.65976147368973 22.20480070992366, -14.71557451981399 22.22477093715091, -14.8206581025195 22.25109300434882, -14.90594999486599 22.29143306509782, -15.13694688264255 22.37408507315013, -15.37493277073839 22.43369743482768, -15.61761572495481 22.46969605050009, -15.86265857577871 22.4817342338196, -16.10770142660261 22.46969605050009, -16.35038438081903 22.43369743482768, -16.39788303796649 22.42179964058564, -16.57611124777833 22.43055543107375, -16.82115409860222 22.41851724775424, -16.89031477907391 22.40825822991765, -16.94578704243195 22.41648676288385, -17.19082989325585 22.42852494620336, -17.43587274407975 22.41648676288385, -17.5503671284345 22.399503125313, -17.67505861594785 22.41799936025091, -17.92010146677175 22.43003754357042, -18.16514431759565 22.41799936025091, -18.40782727181207 22.3820007445785, -18.64505406713305 22.32257852574262, -18.73588422207093 22.35507807484728, -18.97387011016676 22.41469043652483, -19.21655306438318 22.45068905219724, -19.46159591520708 22.46272723551675, -19.70663876603098 22.45068905219724, -19.9493217202474 22.41469043652483, -20.18730760834324 22.35507807484727, -20.41830449611981 22.27242606679497, -20.4307583865337 22.26653581530638, -20.56379166347918 22.23321271416002, -20.79478855125575 22.15056070610771, -21.01657181240802 22.04566503570039, -21.22700555289203 21.91953590558586, -21.42406318075214 21.77338800823634, -21.60584692330939 21.60862882779587, -21.77060610374987 21.42684508523861, -21.91675400109939 21.22978745737851, -22.04288313121391 21.01935371689449, -22.14777880162124 20.79757045574222, -22.23043080967355 20.56657356796565, -22.2900431713511 20.32858767986982, -22.32604178702352 20.0859047256534, -22.33807997034302 19.8408618748295, -22.32604178702352 19.5958190240056, -22.30537123841755 19.45646950438467, -22.3342576214756 19.34114859891324, -22.37025623714802 19.09846564469682, -22.38229442046752 18.85342279387292, -22.37025623714802 18.60837994304902, -22.35423385062678 18.50036578689495, -22.35761020545555 18.43163850548751, -22.37766358477907 18.29644960321025, -22.38970176809858 18.05140675238635, -22.37766358477907 17.80636390156245, -22.37260135853582 17.7722371442781, -22.38305833385616 17.55938052168966, -22.38181414347826 17.53405444473314, -22.41197150930309 17.33074999835235, -22.4240096926226 17.08570714752844, -22.41197150930309 16.84066429670454, -22.40636946919279 16.80289840992767, -22.44403823256925 16.65251627687095, -22.48003684824166 16.40983332265453, -22.49207503156117 16.16479047183062, -22.48003684824166 15.91974762100672, -22.44403823256925 15.6770646667903, -22.43547952265877 15.64289638152731, -22.42650680380195 15.4602524933292, -22.39050818812954 15.21756953911278, -22.33192658845886 14.98369868361621, -22.34105686595574 14.79784761562138, -22.32901868263623 14.55280476479748, -22.29302006696381 14.31012181058106, -22.26462335331059 14.19675577495375, -22.26277109686172 14.15905222877569, -22.22677248118931 13.91636927455927, -22.16716011951175 13.67838338646343, -22.10462297699719 13.50360378180867, -22.14988328742593 13.42809151584489, -22.25477895783326 13.20630825469262, -22.33743096588557 12.97531136691605, -22.39704332756312 12.73732547882022, -22.43304194323554 12.4946425246038, -22.44508012655504 12.2495996737799, -22.43304194323554 12.00455682295599, -22.39704332756312 11.76187386873957, -22.33743096588557 11.52388798064374, -22.25477895783326 11.29289109286717, -22.19678075951196 11.1702642054589, -22.231853125918 10.93382551658731, -22.2438913092375 10.68878266576341, -22.231853125918 10.44373981493951, -22.19585451024558 10.20105686072309, -22.13624214856803 9.963070972627253, -22.05359014051572 9.732074084850684, -22.04396671166407 9.711727054073368, -22.00373838951193 9.599296425506699, -22.03882619823041 9.525109487055827, -22.12147820628271 9.294112599279259, -22.18109056796027 9.056126711183422, -22.21708918363268 8.813443756967004, -22.2200347057179 8.75348627752272, -22.26415027510652 8.630191520729721, -22.32376263678407 8.392205632633884, -22.35976125245649 8.149522678417465, -22.37179943577599 7.904479827593563, -22.36111420259841 7.686976909581786, -22.394861026681 7.459474301195111, -22.4068992100005 7.214431450371209, -22.394861026681 6.969388599547307, -22.39454427325957 6.967253221432506, -22.39663570074542 6.958903774881473, -22.43263431641783 6.716220820665053, -22.44467249973734 6.471177969841151, -22.43263431641783 6.22613511901725, -22.42520472119385 6.176048856423258, -22.45924851244561 5.946544257999629, -22.47128669576512 5.701501407175727, -22.45924851244561 5.456458556351826, -22.42324989677319 5.213775602135406, -22.36363753509564 4.975789714039571, -22.30467603942607 4.811003372857127, -22.30921191741285 4.798326443125212, -22.36882427909041 4.560340555029376, -22.40482289476282 4.317657600812956, -22.41686107808233 4.072614749989055, -22.40482289476282 3.827571899165153, -22.38282310228573 3.679261345251841, -22.38695198811661 3.667721882395539, -22.44656434979417 3.429735994299703, -22.48256296546658 3.187053040083284, -22.49460114878609 2.942010189259382, -22.48256296546658 2.69696733843548, -22.44656434979417 2.454284384219061, -22.38695198811661 2.216298496123226, -22.37396184882762 2.1799934889219, -22.38658792514858 2.129587366737637, -22.422586540821 1.886904412521218, -22.43462472414051 1.641861561697316, -22.422586540821 1.396818710873414, -22.38658792514858 1.154135756656995, -22.3592771699918 1.045105110367365, -22.36350762099722 0.9589923018873644, -22.35146943767771 0.7139494510634626, -22.34532001016119 0.6724933781402493, -22.33427096093755 0.4475848143815596, -22.29827234526513 0.2049018601651402, -22.23865998358758 -0.03308402793069509, -22.20425046928654 -0.1292521779944436, -22.261279888389 -0.2886387269097357, -22.32089225006656 -0.5266246150055711, -22.35689086573897 -0.7693075692219906, -22.36718807520162 -0.9789120830667672, -22.42620471134769 -1.214519701527199, -22.46220332702011 -1.457202655743619, -22.47424151033962 -1.702245506567521, -22.46220332702011 -1.947288357391422, -22.42889752836875 -2.171817813823874, -22.43856291195954 -2.36856121658928, -22.42652472864004 -2.613604067413182, -22.4058295706438 -2.753119490067378, -22.40429375712431 -2.784381692441204, -22.40814810495108 -2.799769111506142, -22.4441467206235 -3.042452065722562, -22.456184903943 -3.287494916546463, -22.4441467206235 -3.532537767370365, -22.42631024597718 -3.652781512278879, -22.46166535455815 -3.891126294065749, -22.47370353787766 -4.13616914488965, -22.46166535455815 -4.381211995713552, -22.42566673888573 -4.623894949929971, -22.41659300653852 -4.660119320014077, -22.39777047505845 -4.787010520136427, -22.33815811338089 -5.024996408232262, -22.29060748755867 -5.157891504620128, -22.29667697197584 -5.198808644943893, -22.30871515529535 -5.443851495767794, -22.29913718581248 -5.638815543489387, -22.31302053289855 -5.732409467097974, -22.32505871621806 -5.977452317921876, -22.31302053289855 -6.222495168745778, -22.27702191722613 -6.465178122962197, -22.23700130787304 -6.624949351462579, -22.26191986068643 -6.792936589265861, -22.27337292135948 -7.026068995003135, -22.28286374225524 -7.046135649814543, -22.36551575030755 -7.277132537591112, -22.4251281119851 -7.515118425686947, -22.46112672765752 -7.757801379903367, -22.47316491097703 -8.002844230727268, -22.46112672765752 -8.24788708155117, -22.44973433808717 -8.324688333623625, -22.45836137069585 -8.500295616589442, -22.4573686685416 -8.520502533151651, -22.46998143377628 -8.605530889681926, -22.48201961709579 -8.850573740505828, -22.46998143377628 -9.09561659132973, -22.43398281810386 -9.33829954554615, -22.37437045642631 -9.576285433641985, -22.291718448374 -9.807282321418555, -22.18682277796667 -10.02906558257082, -22.06069364785215 -10.23949932305483, -22.01967276381155 -10.29480958237682, -22.00439035799606 -10.35582036634663, -21.92173834994376 -10.5868172541232, -21.8468060799781 -10.74524822781346, -21.92842458012701 -10.91781604746789, -21.99191048529292 -11.09524726609872, -22.01966467653555 -11.15392857315868, -22.10231668458785 -11.38492546093525, -22.16192904626541 -11.62291134903108, -22.19792766193782 -11.8655943032475, -22.19817821472779 -11.87069442245198, -22.23112272730048 -11.94034974194297, -22.31377473535278 -12.17134662971954, -22.37338709703034 -12.40933251781537, -22.40938571270275 -12.65201547203179, -22.42142389602226 -12.89705832285569, -22.40938571270275 -13.14210117367959, -22.37338709703034 -13.38478412789601, -22.31377473535278 -13.62277001599185, -22.29252178711778 -13.68216802717211, -22.29289905870317 -13.68984756671441, -22.29056292959623 -13.73740056711855, -22.29317150663481 -13.74291593987261, -22.37582351468712 -13.97391282764918, -22.43543587636467 -14.21189871574502, -22.47143449203709 -14.45458166996143, -22.48347267535659 -14.69962452078534, -22.47143449203709 -14.94466737160924, -22.43543587636467 -15.18735032582566, -22.42770850858644 -15.21819970725584, -22.40572505302204 -15.36640012664985, -22.43309942964606 -15.47568476407415, -22.46909804531847 -15.71836771829057, -22.48113622863798 -15.96341056911447, -22.46909804531847 -16.20845341993838, -22.43309942964606 -16.4511363741548, -22.3734870679685 -16.68912226225063, -22.29704609402757 -16.90276047256235, -22.33318673279856 -17.00376679140546, -22.39279909447611 -17.2417526795013, -22.42879771014853 -17.48443563371772, -22.44083589346804 -17.72947848454162, -22.42879771014853 -17.97452133536552, -22.39279909447611 -18.21720428958194, -22.3612750894556 -18.34305517218451, -22.38618093327824 -18.41266234260967, -22.4457932949558 -18.65064823070551, -22.48179191062821 -18.89333118492193, -22.49383009394772 -19.13837403574583, -22.48179191062821 -19.38341688656973, -22.46272989236197 -19.51192257546279, -22.47144518575322 -19.68932644793065, -22.45940700243371 -19.93436929875455, -22.4234083867613 -20.17705225297097, -22.36379602508374 -20.41503814106681, -22.28114401703143 -20.64603502884338, -22.1762483466241 -20.86781828999564, -22.05011921650958 -21.07825203047966, -21.90397131916006 -21.27530965833976, -21.73921213871958 -21.45709340089702, -21.55742839616233 -21.62185258133749, -21.36037076830222 -21.76800047868701, -21.14993702781821 -21.89412960880153, -20.92815376666594 -21.99902527920887, -20.69715687888937 -22.08167728726117, -20.45917099079353 -22.14128964893872, -20.42744614576441 -22.14599558515562, -20.37281740980389 -22.17183305301641, -20.14182052202732 -22.25448506106872, -19.90383463393149 -22.31409742274627, -19.66115167971507 -22.35009603841869, -19.63541513605011 -22.3513603937329, -19.53556033746936 -22.37637271868991, -19.29287738325294 -22.41237133436232, -19.04783453242904 -22.42440951768183, -18.80279168160514 -22.41237133436232, -18.56010872738872 -22.37637271868991, -18.32212283929288 -22.31676035701235, -18.15038036764053 -22.25530991806244, -17.93163213536989 -22.26605632960654, -17.86833950280889 -22.2629469619552, -17.85807912611075 -22.2677997587208, -17.62708223833419 -22.35045176677311, -17.38909635023835 -22.41006412845066, -17.14641339602193 -22.44606274412307, -16.90137054519803 -22.45810092744258, -16.65632769437413 -22.44606274412307, -16.4990865892769 -22.42273822951685, -16.38947103094286 -22.45019549751362, -16.14678807672644 -22.48619411318603, -15.90174522590254 -22.49823229650554)))";
		Geometry shapelyGeom = OperatorImportFromWkt.local().execute(0, Geometry.Type.Unknown, shapelyWKT, null);
		Geometry eplGeom = OperatorImportFromWkt.local().execute(0, Geometry.Type.Unknown, eplWKT, null);
		NonSimpleResult nonSimpleResult = new NonSimpleResult();
		boolean is_simple = OperatorSimplify.local().isSimpleAsFeature(shapelyGeom, null, true, nonSimpleResult, null);
		assertFalse(is_simple);
		assertTrue(OperatorSimplify.local().isSimpleAsFeature(eplGeom, null, true, nonSimpleResult, null));
	}

	@Test
	public void testIDPass() {
		int size = 1000;
		List<String> points = new ArrayList<>(size);
		List<Point> pointList = new ArrayList<>(size);
		for (int i = 0; i < size; i++) {
			double x = randomWithRange(-20, 20);
			double y = randomWithRange(-20, 20);
			points.add(String.format("Point(%f %f)", x, y));
			pointList.add(new Point(x, y));
		}

		SimpleStringCursor simpleStringCursor = new SimpleStringCursor(points);
		OperatorImportFromWktCursor operatorImportFromWktCursor = new OperatorImportFromWktCursor(0, simpleStringCursor);
		double[] distances = new double[]{2.5};

		GeometryCursor operatorBufferCursor = OperatorBuffer.local().execute(operatorImportFromWktCursor,
				null,
				distances,
				Double.NaN,
				0,
				true,
				null);

		OperatorExportToWkbCursor operatorExportToGeoJsonCursor = new OperatorExportToWkbCursor(0, operatorBufferCursor);

		while (operatorExportToGeoJsonCursor.hasNext()) {
			ByteBuffer wkb = operatorExportToGeoJsonCursor.next();
			long id = operatorExportToGeoJsonCursor.getByteBufferID();
		}
	}

	static double randomWithRange(double min, double max) {
		double range = Math.abs(max - min);
		return (Math.random() * range) + (min <= max ? min : max);
	}
//    @Test
//    @Ignore
//    public void testGeodesicBufferUnionPoint() {
//        int size = 2;
//        SimpleGeometryCursor simpleGeometryCursor = new SimpleGeometryCursor(pointList);
//        double[] d = {2500};
//        OperatorGeodesicBufferCursor operatorGeodesicBufferCursor = new OperatorGeodesicBufferCursor(simpleGeometryCursor, SpatialReference.create(4326), d, 1.0, false, true, null);
//        // Tests union on buffer at next call
//        Geometry result = operatorGeodesicBufferCursor.next();
//        assertTrue(result.calculateArea2D() > 0);
//    }
}
